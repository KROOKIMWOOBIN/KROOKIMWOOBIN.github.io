---
title: "Java"
excerpt: "CS PART4"

categories: [CS]
tags: [Computer Science, Java]

toc: true
toc_sticky: true

date: 2024-05-10 02:29:00 +0800
last_modified_at: 2024-05-10 02:54:00 +0800

pin: false
---

## Garbage Collection(GC)

### GC란?
> 자바의 메모리 관리 방법 중의 하나로
JVM의 Heap 영역에서 동적으로 할당했던 메모리 중
필요 없게 된 메모리 객체를 모아 주기적으로 
제거하는 프로세스를 말한다.

#### 장점
> C / C++ 언어에서는 이러한 GC가 없어 개발자가 수동으로
메모리 할당과 해제를 일일이 해줘야 했었다.
반면 Java에서는 GC가 메모리 관리를 대행해주기 때문에
개발자는 개발에만 집중할 수 있다.

#### 단점
> 자동으로 처리해준다 해도 메모리가 언제 해제되는지 정확하게
알 수 없어 제어하기 힘들며, GC가 동작하는 동안에는
다른 동작을 멈추기 때문에 오버헤드가 발생되는 문제점이 있다.
이를 전문적인 용어로 ***Stop-The-World***라 한다.

##### STW(Stop The World)?
> GC를 수행하기 위해 JVM이 프로그램 실행을 멈추는 현상을 의미
GC가 작동하는 동안 GC관련 Thread를 제외한 모든 Thread는
멈추게 되어 서비스 이용에 차질이 생길 수 있다.
따라서 이 시간을 최소화 시키는 것이 쟁점이다.

##### 해결 방법
> 실시간 성이 강조되는 프로그램일 경우 GC에게 
메모리를 맞기는 것은 맞지 않을 수 있다.
따라서 사용성을 유지하면서 GC를 실행하는 최적화 작업이 개발자의 숙제가 된다.
그리고 이러한 GC 최적화 작업을 ***GC 튜닝***이라고 한다.

### GC 대상
> GC는 특정 객체가 가비지인지 아닌지 판단하기 위해서 도달성,
도달능력(REachability)이라는 개념을 적용한다.
객체에 레퍼런스가 있다면 Reachable로 구분되고, 
객체에 유효한 레퍼런스가 없다면 Unreachable로 구분된다.
- Reachable? 객체가 참조되고 있는 상태
- Unreachable? 객체가 참조되고 있지 않은 상태

### GC 청소 방식

#### Mark And Sweep
> 다양한 GC에서 사용되는 객체를 솎아내는 내부 알고리즘이다.
GC에서 동작하는 아주 기초적인 청소 과정이라고 생각하면 된다.

##### 원리
> GC가 될 대상 객체를 식별(Mark)하고 제거(Sweep)하며 객체가 제거되어 파편화된 메모리 영역을
앞에서부터 채워나가는 작업(Compaction)을 수행하게 된다.
- Mark 과정
  - 먼저 Root Space로부터 그래프 순회를 통해 연결된 객체들을 찾아내어 각각 어떤 객체를 참고하고 있는지 찾아서 마킹한다.
- Sweep 과정
  - 참조하고 있지 않느 개체들을 Heap에서 제거한다.
- Compact 과정
  - Sweep 후에 분산된 객체들을 Heap의 시작 주소로 모아 메모리가 할당된 부분과 그렇지 않은 부분으로 압축한다. (GC 종류에 따라 하지 않는 경우도 있음)

### Heap 메모리의 구조

## 참고 자료
> https://inpa.tistory.com/entry/JAVA-%E2%98%95-%EA%B0%80%EB%B9%84%EC%A7%80-%EC%BB%AC%EB%A0%89%EC%85%98GC-%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%F0%9F%92%AF-%EC%B4%9D%EC%A0%95%EB%A6%AC